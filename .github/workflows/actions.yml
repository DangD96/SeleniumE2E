name: Selenium Tests in GitHub Runner

on:
  push:
    branches:
      - master
    paths:
      # Only trigger workflow when pushing to master branch with changes to files under these directories
      - 'src/**'
      - '.github/workflows/**'
      - 'test-suites/**'
  workflow_dispatch:
    inputs:
      run_browser:
        description: 'Pick a browser to run tests on'
        required: true
        default: 'Chrome'
        type: choice
        options:
          - Chrome
          - Edge
          - Firefox

jobs:
  test:
    runs-on: ubuntu-latest
    # This image comes with multiple things pre-installed so don't have to install them in this yaml file
    # -Maven
    # -Java 17
    # -Chrome, Edge, and Firefox browsers
    # https://github.com/actions/runner-images?tab=readme-ov-file#available-images

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      # $GITHUB_ENV is a file used by GitHub Actions. Takes (>>) key-value pairs to define env variables
      # BROWSER env variable will either be what you pick from GitHub (run_browser) or "Chrome" if run_browser is null (which happens on push)
      - name: Set browser
        run: echo "BROWSER=${{ github.event.inputs.run_browser || 'Chrome' }}" >> $GITHUB_ENV

      - name: Run tests with Maven
        run: mvn clean test -Denv=PRD -Dbrowser=$BROWSER -DtestSuite=DJDSuite.xml -Durl=https://www.rahulshettyacademy.com/loginpagePractise/

      - name: Upload HTML Results Report
        uses: actions/upload-artifact@v4
        with:
          name: Test Results
          path: test-results/*.html # Match and upload any HTML file under the test-results directory
